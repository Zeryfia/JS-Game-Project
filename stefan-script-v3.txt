"use strict";

const computerPlay = (list) => {

	let option = null;

	let random = Math.floor(Math.random()*list.length);

	option = list[random];

	return option;
}

const validateInput = (text, arr) => {

	let temp = text.trim();

	let input = temp.toLowerCase();

	if ( arr.indexOf(input) != -1 )

		return input;

	else
		return false;
}

const playerOption = () => {

	let accepted = '';

	 do {

		let userText = prompt("Choose your weapon: Rock, Paper, or Scissors");

		if (userText === null)
			return null;
		
		accepted = validateInput(userText, ['rock', 'scissors', 'paper']);

		if (!accepted)
			alert("Invalid choice! Please choose again: Rock, Paper, or Scissors");
		
		} while (!accepted);

	return accepted;
}

const cancelGame = () => {
  logAndAlert('The game has been canceled. Farewell!');
  return;
};

const logAndAlert = (message) => {
  console.log(message);
  alert(message);
};

const PlayRound = (playerSelection, computerSelection) => {

	let output = null;

	if ( playerSelection === computerSelection )

		output = "It is a Draw!";

	else {

		switch(playerSelection) {

			case 'rock':

			computerSelection == 'scissors' ? output = "You win! Rock beats Scissors" :
			computerSelection == 'paper' ? output = "You lose! Paper beats Rock" : output="default";

			break;

			case 'scissors':

			computerSelection == 'paper' ? output = "You win! Scissors beat Paper" :
			computerSelection == 'rock' ? output = "You lose! Rock beats Scissors" : output="default";

			break;

			case 'paper':

			computerSelection == 'rock' ? output = "You win! Paper beats Rock" :
			computerSelection == 'scissors' ? output = "You lose! Scissors beat Paper" : output="default";

			break;
		}
	}

	return output;
}

const evaluateRound = (result, score, i) => {

	if (result.includes("win"))
		score['player'] += 1;

	else if (result.includes("lose"))
		score['comp'] += 1;

	console.log(`Round ${i+1}. ${result}. Score You ${score['player']} : Comp ${score['comp']} `);

}

const getFinalResult = (score) => {

	if ( score['player'] == score['comp'] )

		console.log(`The Final result of the game is a DRAW, the score is P ${score['player']} : C ${score['comp']}`);

	else {

		let champion = ( score['player'] > score['comp'] ? "Player" : "Computer" );

		console.log(`The Winner of this game is ${champion}, the score is Player ${score['player']} : Computer ${score['comp']} `);
	}
}


(function game() {

	const moves = ['rock', 'scissors', 'paper'];

	const maxRounds = 5;

	let score = {"player": 0, "comp": 0};

	let playerSelection = null;

	let computerSelection = null;


	for (let i=0; i < maxRounds; i++)
	{

		computerSelection = computerPlay(moves);
		
		playerSelection = playerOption();

		if (playerSelection === null) {
			cancelGame();
			return;
		}

		alert("Computer\'s selection is " + computerSelection.toUpperCase());

		let roundResult = PlayRound(playerSelection, computerSelection);

		evaluateRound( roundResult, score, i );
	}

	getFinalResult(score);


})();

